<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  File: README
  
    &mdash; Documentation by YARD 0.9.34
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" />

  <link rel="stylesheet" href="css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="puppet_class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="puppet_class_list_link"
        href="puppet_class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><div id='filecontents'>
<h1 id="label-puppet-module-etcd">puppet-module-etcd</h1>

<h4 id="label-Table+of+Contents">Table of Contents</h4>
<ol><li>
<p><a href="#module-description">Module Description</a></p>
</li><li>
<p><a href="#setup">Setup - The basics of getting started with Etcd</a></p>
<ul><li>
<p><a href="#what-etcd-affects">What etcd affects</a></p>
</li><li>
<p><a href="#setup-requirements">Setup requirements</a></p>
</li></ul>
</li><li>
<p><a href="#usage">Usage - Configuration options and additional functionality</a></p>
<ul><li>
<p><a href="#basic-etcd">Basic Etcd</a></p>
</li><li>
<p><a href="#clustered-etcd">Clustered Etcd</a></p>
</li><li>
<p><a href="#etcd-upgrades">Etcd Upgrades</a></p>
</li><li>
<p><a href="#ssl-configuration">SSL configuration</a></p>
</li></ul>
</li><li>
<p><a href="#reference">Reference</a></p>
</li><li>
<p><a href="#limitations">Limitations - OS compatibility, etc.</a></p>
</li></ol>

<h2 id="label-Module+Description">Module Description</h2>

<p>Installs and manages <a href="https://etcd.io/">Etcd</a></p>

<h3 id="label-Documented+with+Puppet+Strings">Documented with Puppet Strings</h3>

<p><a href="http://tailored-automation.github.io/puppet-module-etcd/">Puppet Strings documentation</a></p>

<h2 id="label-Setup+-+The+basics+of+getting+started+with+Etcd">Setup - The basics of getting started with Etcd</h2>

<h2 id="label-What+etcd+affects">What etcd affects</h2>

<p>This module will download the compiled binaries for etcd and extra the archive and install the necessary binaries, configuration files and services.</p>

<h2 id="label-Setup+requirements">Setup requirements</h2>

<p>All module dependencies are listed in this module’s <code>metadata.json</code>.</p>

<h2 id="label-Usage+-+Configuration+options+and+additional+functionality">Usage - Configuration options and additional functionality</h2>

<h3 id="label-Basic+Etcd">Basic Etcd</h3>

<p>To install and run a single instance of etcd it’s sufficient to just include the <code>etcd</code> class:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_include'>include</span> <span class='id identifier rubyid_etcd'>etcd</span>
</code></pre>

<p>All configuration for etcd.yaml is done via the <code>config</code> parameter, example:</p>

<pre class="code ruby"><code class="ruby">class { &#39;etcd&#39;:
  config =&gt; {
    &#39;data-dir&#39; =&gt; &#39;/var/lib/etcd&#39;,
    &#39;wal-dir&#39;  =&gt; &#39;/var/lib/etcd/wal&#39;,
  },
}
</code></pre>

<h3 id="label-Clustered+Etcd">Clustered Etcd</h3>

<p>The following is an example of a clustered etcd setup. Adjust <code>name</code>, <code>initial-advertise-peer-urls</code> and <code>advertise-client-urls</code> for each host in the cluster.</p>

<pre class="code ruby"><code class="ruby">class { &#39;etcd&#39;:
  config =&gt; {
    &#39;data-dir&#39;                    =&gt; &#39;/var/lib/etcd&#39;,
    &#39;name&#39;                        =&gt; &#39;infra1&#39;,
    &#39;initial-advertise-peer-urls&#39; =&gt; &#39;http://10.0.1.10:2380&#39;,
    &#39;listen-peer-urls&#39;            =&gt; &#39;http://0.0.0.0:2380&#39;,
    &#39;listen-client-urls&#39;          =&gt; &#39;http://0.0.0.0:2379&#39;,
    &#39;advertise-client-urls&#39;       =&gt; &#39;http://10.0.1.10:2379&#39;,
    &#39;initial-cluster-token&#39;       =&gt; &#39;etcd-cluster-1&#39;,
    &#39;initial-cluster&#39;             =&gt; &#39;infra0=http://10.0.1.10:2380,infra1=http://10.0.1.11:2380,infra2=http://10.0.1.12:2380&#39;,
    &#39;initial-cluster-state&#39;       =&gt; &#39;new&#39;,
  },
}
</code></pre>

<h3 id="label-Etcd+Upgrades">Etcd Upgrades</h3>

<p>Upgrades using this module are performed by increasing the value provided to <code>version</code>.</p>

<p>If the previous version was <code>3.4.7</code> then the following would upgrade etcd to <code>4.0.0</code>:</p>

<pre class="code ruby"><code class="ruby">class { &#39;etcd&#39;:
  version =&gt; &#39;4.0.0&#39;,
}
</code></pre>

<p>Puppet will download the new etcd, update the symlinks for etcd binary and restart the etcd service.</p>

<h3 id="label-SSL+configuration">SSL configuration</h3>

<p>Below is an example of setting up SSL authentication as well as SSL peering between hosts in etcd cluster:</p>

<pre class="code ruby"><code class="ruby">class { &#39;etcd&#39;:
  config =&gt; {
    &#39;name&#39;                        =&gt; $facts[&#39;networking&#39;][&#39;fqdn&#39;],
    &#39;initial-advertise-peer-urls&#39; =&gt; &quot;https://${facts[&#39;networking&#39;][&#39;fqdn&#39;]}:2380&quot;,
    &#39;listen-peer-urls&#39;            =&gt; &quot;https://${facts[&#39;networking&#39;][&#39;ip&#39;]}:2380&quot;,
    &#39;listen-client-urls&#39;          =&gt; &quot;https://${facts[&#39;networking&#39;][&#39;ip&#39;]}:2379&quot;,
    &#39;advertise-client-urls&#39;       =&gt; &quot;https://${facts[&#39;networking&#39;][&#39;fqdn&#39;]}:2379&quot;,
    &#39;initial-cluster-token&#39;       =&gt; &#39;etcd-cluster-1&#39;,
    &#39;initial-cluster&#39;             =&gt; &#39;https://etcd1.example.com:2380,https://etcd2.example.com:2380,https://etcd3.example.com:2380&#39;,
    &#39;initial-cluster-state&#39;       =&gt; &#39;new&#39;,
    &#39;client-transport-security&#39;   =&gt; {
      &#39;trusted-ca-file&#39;  =&gt; &#39;/etc/pki/tls/my-ca.pem&#39;,
      &#39;cert-file&#39;        =&gt; &#39;/etc/pki/tls/etcd.crt&#39;,
      &#39;key-file&#39;         =&gt; &#39;/etc/pki/tls/etcd.key&#39;,
      &#39;client-cert-auth&#39; =&gt; true,
    },
    &#39;peer-transport-security&#39;     =&gt; {
      &#39;trusted-ca-file&#39;  =&gt; &#39;/etc/pki/tls/my-ca.pem&#39;,
      &#39;cert-file&#39;        =&gt; &#39;/etc/pki/tls/etcd.crt&#39;,
      &#39;key-file&#39;         =&gt; &#39;/etc/pki/tls/etcd.key&#39;,
      &#39;client-cert-auth&#39; =&gt; true,
    },
  },
}
</code></pre>

<h3 id="label-Reference">Reference</h3>

<p><a href="http://tailored-automation.github.io/puppet-module-etcd/">Puppet Strings documentation</a></p>

<h3 id="label-Limitations">Limitations</h3>

<p>This module is only supported on Linux based systems.</p>
</div></div>

      <div id="footer">
     Generated by <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>.
</div>

    </div>
  </body>
</html>